package net.minecraft.client;

import java.io.BufferedReader;
import java.io.File;
import java.io.FileReader;
import java.io.FileWriter;
import java.io.PrintWriter;
import org.lwjgl.input.Keyboard;

public final class GameSettings {
    
    private static final String[] RENDER_DISTANCES = new String[]{ "Far", "Normal", "Short", "Tiny" };
    private static final String[] DIFFICULTIES = new String[]{ "Peaceful", "Easy", "Normal", "Hard" };
    
    private Minecraft mc;
    private File optionsFile;
    
    public int numberOfOptions = 10; // Update to reflect the new option
    public int difficulty = 2;
    public boolean thirdPersonView = false;
    public boolean music = true;
    public boolean sound = true;
    public boolean invertMouse = false;
    public boolean showFPS = false;
    public int renderDistance = 0;
    public boolean fancyGraphics = true;
    public boolean anaglyph = false;
    public boolean limitFramerate = false;
    public boolean showExitWarning = true; // New field for exit warning

    // Key bindings...

    public GameSettings(Minecraft mc, File fileRoot) {
        this.mc = mc;
        this.optionsFile = new File(fileRoot, "options.txt");
        this.loadOptions();
    }

    public final String setKeyBindingString(int keyBindID) {
        return this.keyBindings[keyBindID].keyDescription + ": " + Keyboard.getKeyName(this.keyBindings[keyBindID].keyCode);
    }

    public final void setKeyBinding(int keyBindID, int keyCode) {
        this.keyBindings[keyBindID].keyCode = keyCode;
        this.saveOptions();
    }

    public final void setOptionValue(int optionID, int value) {
        switch (optionID) {
            // Existing cases...

            case 9: // Update to handle new option
                this.showExitWarning = !this.showExitWarning;
                break;
        }

        this.saveOptions();
    }

    public final String setOptionString(int optionID) {
        switch (optionID) {
            // Existing cases...

            case 9: return "Show Exit Warning: " + (this.showExitWarning ? "ON" : "OFF");
            default: return "";
        }
    }

    private void loadOptions() {
        try {
            if(this.optionsFile.exists()) {
                BufferedReader reader = new BufferedReader(new FileReader(this.optionsFile));
                String line;
                while((line = reader.readLine()) != null) {
                    String[] parts = line.split(":");
                    if(parts[0].equals("music")) {
                        this.music = parts[1].equals("true");
                    }
                    // Other options...
                    if(parts[0].equals("showExitWarning")) {
                        this.showExitWarning = parts[1].equals("true");
                    }
                }
                reader.close();
            }
        } catch (Exception e) {
            System.out.println("Failed to load options");
            e.printStackTrace();
        }
    }

    public final void saveOptions() {
        try {
            PrintWriter out = new PrintWriter(new FileWriter(this.optionsFile));
            out.println("music:" + this.music);
            // Other options...
            out.println("showExitWarning:" + this.showExitWarning);
            out.close();
        } catch (Exception e) {
            System.out.println("Failed to save options");
            e.printStackTrace();
        }
    }
}
